<!-- inv.html -->
<!-- Displays list of items currently in cabinet -->
<!-- For debugging: user can also add items manually -->
<!-- 

TODO: 
- support writing items in recipes that aren't in the fridge (yet)
- mark presence of item somewhere with a checkmark

 -->

{% extends "dashboard.html" %}


{% block head %}
  <title>{{ device.name }} - Food Tracker</title>
{% endblock %}


{% block script %}
    {% load static %}
    <!-- Question: shouldn't this be handled in base.html???? -->

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="{% static 'ajax_inv.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        var myUserName = "{{ request.user }}"
        var addItemURL = "{% url 'ajax-add-item' %}"
        var deleteItemURL = function (id) { 
            "{% url 'ajax-del-item' 0 %}".replace("0", id)
        }

        // Call getList() as soon as page is finished loading to display the list
        window.onload=getList()

        // ... also call getList every 5 seconds hereafter to update the list
        window.setInterval(getList, 5000);

    </script>
{% endblock %}


{% block content %}
    <h1>{{ device.name }}</h1>
    {% if message %}
    <h2> {{ message }} </h2>
    <!-- elif request.session.message -->
    <!-- <h2> request.session.message </h2> -->
    {% endif %}
    <div id="inv-list">
        <ul>
            <li>
                <!-- Shamelessly stolen from 17-437 hw2 -->
                <!-- <form class="add-form" action="{% url 'add_item' device.id %}" method="post"> -->
                    <label>Manually add/remove Items:</label>
                    <input type="text" name="item" autofocus>
                    <!-- <input type="submit"> -->
                    <button onclick="addItem()">Add item</button>
                    <span id="error" class="error"></span>
                    {% csrf_token %}
                <!-- </form> -->
            </li>
            {% for item in items %}
            <li>{{ item.type.name }},
                <span class="details">{{ item }}</span>
                <form action="{% url 'del_item' item.id %}" method="post">
                    {% csrf_token %}
                    <button class="delete" type="submit">Delete</button>
                </form>
            </li>
            {% endfor %}
        </ul>
    </div>

    <!-- <h1>Cabinet name</h1>
    <ul>
        <li>Spice 1</li>
        <li>Spice 2</li>
        <li>Spice 3</li>
    </ul> -->
{% endblock %}
